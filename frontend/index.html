<!-- /container --><!DOCTYPE html>
<html lang="en">
<head>
 <title>Text Scanner</title>
 <link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">
 <link href="https://fonts.googleapis.com/css?family=Fjalla+One&display=swap" rel="stylesheet">
 <meta charset="utf-8">
 <meta content="width=device-width, initial-scale=1" name="viewport">
 <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css" rel="stylesheet">
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
 
 <link href="styles.css" rel="stylesheet">
</head>
<body style="background-image: linear-gradient(-100deg,white,skyblue);">
     <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
     if (localStorage.getItem("token")==="")
          window.location.href="home.html"
</script>
<nav class="navbar navbar-inverse">
 <div class="container-fluid">
  <div class="navbar-header">
   <a class="navbar-brand" href="index.html" style="font-family: fantasy">Text Scanner</a>
  </div>
  <ul class="nav navbar-nav" style="float: right;">
   <li ><a href=index.html.html><img src="log2.png" style="
        height: 30px;
        border-radius: 0%;
        overflow:auto;
        margin-top: -6px;"></a></li></a></li>
   <li onclick="logout()"><a href="home.html">Sign out</a></li>
  </ul>
 </div>
</nav>
<main role="main" class="container">

 <form class="mb-3 dm-uploader" id="drag-and-drop-zone">
  <div class="form-row">
   <div class="col-md-10 col-sm-12">
    <div class="from-group mb-2">
     <label>Image Uploader</label>
     <input type="text" class="form-control" aria-describedby="fileHelp" placeholder="No image uploaded..." readonly="readonly">

     <div class="progress mb-2 d-none">
      <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" id="bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="0">
       10%
      </div>
     </div>

    </div>
    <div class="form-group">
     <div role="button" class="btn btn-primary mr-2">
      <i class="fa fa-folder-o fa-fw"></i> Browse Files
      <input type="file" id="file-selector" title="Click to add Files" accept="image/*">
     </div>
     <small class="status text-muted">Select a file</small>
    </div>
   </div>
   <div class="col-md-2  d-md-block  d-sm-none">
    <img src="https://danielmg.org/assets/image/noimage.jpg?v=v10" alt="..." class="img-thumbnail">
   </div>
  </div>
  <div class="spinner-border" role="status">
     <span class="sr-only">Loading...</span>
   </div>
 </form>
</main> 
<script>
     //const axios = require('axios').default;
     const file=document.getElementById('file-selector')
     file.addEventListener('change',(e)=>{
          console.log(e.target.files)
          const file = event.target.files[0]
          if (file.type!="image/jpeg" && file.type!="image/png"){
               alert("Not an image file")
               window.location.href="index.html"
          }
          let formdata = new FormData();
          formdata.append('image',file,file.name)
          axios({
               method: 'post',
               url:'http://localhost:3000/text/upload',
               data: formdata,
               credentials: 'same-origin',
               headers:{
                    'Authorization':localStorage.getItem('token')
               }
          })
          .then(res=>{
               console.log(res)
               if (res.data.status===200){
                   window.open(
                        res.data.link,
                        '_blank'
                   )
               }else{
                    alert(res.data.message)
               }
          })
          .catch(err=>console.warn(err))
          /*let data={
               image: e.target.files[0]
          }
          console.log(100,data.image)
          fetch('http://localhost:3000/text/upload',{
               method:'POST',
               headers:{
                    'Authorization':localStorage.getItem('token')
               },
               body: data
          })
          .then(res=>res.json())
          .then((resp)=>{
               console.log(resp)
               if (resp.status!==200) alert(resp.message)
          })
          .catch(err=>console.warn(err))*/
     })
     function logout(){
          localStorage.setItem("token","")
     }
     
</script>
</body>
</html>

